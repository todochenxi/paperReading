# Lead-agnostic Self-supervised Learning for Local and Global Representations of Electrocardiogram

## abstract
大多数先前的预训练方法，仅提取全局上下文表示，在下游任务表示不佳。而且如果模型没在数据集上预训练，就无法在该数据集上进行微调
提出了一种 ecg 预训练方法，可以同时提取局部和全局表示，在下游任务上，通用性强，性能好。还提出随机导联针对于ECG的数据增强方法
使得提出的模型对任意的导联鲁棒性更强，实验结果表示，在心率失常分类，和患者识别两个下游任务上，该方法是SOTA。

## introduction
先前的深度学习方法，ecg 监督学习的数据需要有专业背景的人标注，这限制了训练数据的规模，后来开始在无标注数据上使用预训练的方法，然后针对小的特定有标签数据
进行微调，一些方法在预训练和微调基于的假设是ECG data 在与训练和微调时将由同样导联的数据的数据，在现实世界这种方案并不可行，现实世界很难知道那种特定数据集需要
事先微调。所以作者提出了一种预训练方法，可以同时提取ecg 信号的局部和全局表示，并且在微调阶段，随机mask 导联，增强了鲁棒性。在两个下游任务上实现了SOTA，

##　related works
### 心电图
心电图测量通过放置在身体表面的电极获得，通过测量成对的相关附件之间的电压，就可以评估心脏的功能。导联（通道）负责测量特定的
电位差，一般10-12个。
先前的工作现实，对于ecg自动诊断心脏疾病是深度学习的方法是非常有效的，resnet在 heartbeat 分类和MI分类任务上准确率很高，基于transformer的心跳分类器在心率市场分类任务上
也有很高的效率。
使用ecg做生物特征识别是一个很有前景的方向，指纹或面部容易复制，ecg 信息，由神经系统控制，难以伪造。
### 对比自监督学习
学习语音识别领域的 在 潜空间中的输入进行量化和掩蔽，并解决对屏蔽输出和量化特征的对比任务，作为局部连续学习的代表模型。
### 心电图的表示学习
- 全局 v（ector）cg，在心电图的三维空间中，进行旋转、缩放，另一种是来自同一患者的，同一ecg的不同frames（cmsc），同一ecgs的不同导联（cmlc），或者组合一起。作者使用了cmlc，

## pre-training
wav2vec2.0捕获局部特征
cmsc捕获全局特征
以及两者的组合
### wav2vec2.0
使用多个卷积块编码raw ecg 信号输入，多个transformer encoder 块从cnn的输出得到连贯的文本话的局部表示，
此外，源于卷积编码器的潜空间特征被量化用于执行带有局部上下文表示的对比任务。量化是将连续值特征向量（代码）到有限集合的映射过程，codebook包含的向量是从codebook最接近的code中替换的潜空间特征，
raw ecg-卷积编码器产生潜空间特征-transformer产生局部上下文表示-量化-对比任务-量化模块-量化潜空间特征
预训练过程中，在进入transformer前，潜空间特征在随机时间步被量化并被masked，然后，模型被训练为在每个时间步计算局部上下文表示，和相关的量化特征的最大的余弦相似度
这个框架高效捕捉了每个ecg信号的局部和量化表示的突出局部信息。
### cmsc
cmsc介绍了一个针对病人的高效率学习无标签ecg数据的自监督学习方法。利用心电图记录的时间不变性，将相邻的时间片段设置为正对，
具体来说 给定持续时间为 对时间片段进行采样。 不重叠的 Si/2 秒段（见图 1 中原始心电信号下方的持续时间）。
图 1 中原始心电信号下方的持续时间）。 为简便起见，我们将第 i 个心电图信号的持续时间 Si = 10。 i 个心电图信号。
相邻片段 作为正对，其他时间片段从 不同心电图样本的其他时间片段则作为负对。 这种对比学习方法侧重于全局 心电图记录的全局表征。 患者之间心电图记录的相互关系
### wav2vec2.0 + cmsc
集成了wav2vec2.0的架构和cmsc的训练机制通过对比学习学习全局和局部上下文，12通道的原始ecg信号被分割为2*n个样本，n代表
原始的眼本书，被用作局部对比任务的输入。wav2vec2.0，这个模型最小化局部上下文表示和他的量化特征的对比loss，具体来说，
### random lead masking
由于，12导联在现实中的一些场景无法满足，作者用了mask，在预训练阶段，模型会接触到不同的导联组合，从而减少了对所有12个导联的依赖性。妙啊。

## fine-tuning
## info
- citation: 17
- 期刊：chil2022
- 数据集增广
- 心率失常分类和患者识别两个下游任务
- dataset：Physionet 2021 dataset and PTB-XL datase
- 贡献：rlm
-  https://github.com/Jwoo5/fairseq-signals